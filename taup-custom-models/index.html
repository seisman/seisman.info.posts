<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>TauP 自定义模型 - SeisMan</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="SeisMan"><meta name=description content="TauP 内置了常见的一维速度模型，比如 PREM、ak135、iasp91 等，这些标准速度模型 位于 TauP 软件包的 StdModels 目录下。日常科研中，这些标准速度模型是不能满足 需求的，因而需要自定义速度模型。
"><meta name=keywords content="地球物理学,地震学,SAC,软件,开源"><meta name=generator content="Hugo 0.82.0 with theme even"><link rel=canonical href=https://blog.seisman.info/taup-custom-models/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link href=/dist/even.c2a46f00.min.css rel=stylesheet><link href=/lib/fancybox/jquery.fancybox-3.1.20.min.css rel=stylesheet><meta property="og:title" content="TauP 自定义模型"><meta property="og:description" content="TauP 内置了常见的一维速度模型，比如 PREM、ak135、iasp91 等，这些标准速度模型
位于 TauP 软件包的 StdModels 目录下。日常科研中，这些标准速度模型是不能满足
需求的，因而需要自定义速度模型。"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.seisman.info/taup-custom-models/"><meta property="article:section" content="post"><meta property="article:published_time" content="2016-05-21T00:00:00+00:00"><meta property="article:modified_time" content="2016-05-21T00:00:00+00:00"><meta itemprop=name content="TauP 自定义模型"><meta itemprop=description content="TauP 内置了常见的一维速度模型，比如 PREM、ak135、iasp91 等，这些标准速度模型
位于 TauP 软件包的 StdModels 目录下。日常科研中，这些标准速度模型是不能满足
需求的，因而需要自定义速度模型。"><meta itemprop=datePublished content="2016-05-21T00:00:00+00:00"><meta itemprop=dateModified content="2016-05-21T00:00:00+00:00"><meta itemprop=wordCount content="1077"><meta itemprop=keywords content="TauP,模型,"><meta name=twitter:card content="summary"><meta name=twitter:title content="TauP 自定义模型"><meta name=twitter:description content="TauP 内置了常见的一维速度模型，比如 PREM、ak135、iasp91 等，这些标准速度模型
位于 TauP 软件包的 StdModels 目录下。日常科研中，这些标准速度模型是不能满足
需求的，因而需要自定义速度模型。"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>SeisMan</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>首页</li></a><a href=/post/><li class=mobile-menu-item>归档</li></a><a href=/categories/><li class=mobile-menu-item>分类</li></a><a href=/tags/><li class=mobile-menu-item>标签</li></a><a href=https://seismo-learn.org/links/><li class=mobile-menu-item>链接</li></a><a href=http://seisman.qiniudn.com/seisman-blog.pdf><li class=mobile-menu-item>PDF</li></a><a href=/collections/><li class=mobile-menu-item>合集</li></a><a href=/donations/><li class=mobile-menu-item>捐赠</li></a><a href=/about/><li class=mobile-menu-item>关于</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>SeisMan</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>首页</a></li><li class=menu-item><a class=menu-item-link href=/post/>归档</a></li><li class=menu-item><a class=menu-item-link href=/categories/>分类</a></li><li class=menu-item><a class=menu-item-link href=/tags/>标签</a></li><li class=menu-item><a class=menu-item-link href=https://seismo-learn.org/links/>链接</a></li><li class=menu-item><a class=menu-item-link href=http://seisman.qiniudn.com/seisman-blog.pdf>PDF</a></li><li class=menu-item><a class=menu-item-link href=/collections/>合集</a></li><li class=menu-item><a class=menu-item-link href=/donations/>捐赠</a></li><li class=menu-item><a class=menu-item-link href=/about/>关于</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>TauP 自定义模型</h1><div class=post-meta><span class=post-time>2016-05-21</span><div class=post-category><a href=/categories/%E5%9C%B0%E9%9C%87%E5%AD%A6%E8%BD%AF%E4%BB%B6/>地震学软件</a></div></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>文章目录</h2><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#速度模型格式>速度模型格式</a><ul><li><a href=#tvel-格式>tvel 格式</a></li><li><a href=#nd-格式>nd 格式</a></li></ul></li><li><a href=#微调模型>微调模型</a></li><li><a href=#加速计算>加速计算</a></li></ul></nav></div></div><div class=post-content><p>TauP 内置了常见的一维速度模型，比如 PREM、ak135、iasp91 等，这些标准速度模型
位于 TauP 软件包的 <code>StdModels</code> 目录下。日常科研中，这些标准速度模型是不能满足
需求的，因而需要自定义速度模型。</p><h2 id=速度模型格式>速度模型格式</h2><p>通常，自定义的模型都是在标准模型的基础上对少量改动。所以，要想自定义模型，先要了解
TauP 模型的格式。TauP 支持两种速度模型格式： <code>nd</code> 和 <code>tvel</code>。</p><h3 id=tvel-格式>tvel 格式</h3><p>以 ak135 模型为例，其前 10 行的内容如下：</p><pre><code>$ head -10 ak135.tvel
ak135 - P
ak135 - S
     0.000      5.8000      3.4600     2.7200
    20.000      5.8000      3.4600      2.7200
    20.000      6.5000      3.8500      2.9200
    35.000      6.5000      3.8500      2.9200
    35.000      8.0400      4.4800      3.3198
    77.500      8.0450      4.4900      3.3455
   120.000      8.0500      4.5000      3.3713
   165.000      8.1750      4.5090      3.3985
</code></pre><p>其中前两行是注释行，会被自动忽略，但这两行是必须的。接下来每行给定一个深度处的参数值，
两个深度之间的参数通过线性插值得到。若某个深度处有两个不同的参数值，则该深度处是一个
速度界面，比如上面的几行中 20 和 35 都是速度界面，其余深度则不是。</p><h3 id=nd-格式>nd 格式</h3><p>以 PREM 模型为例，其前 10 行的内容如下：</p><pre><code>$ head -10 prem.nd
    0.00     5.80000   3.20000   2.60000    1456.0     600.0
   15.00     5.80000   3.20000   2.60000    1456.0     600.0
   15.00     6.80000   3.90000   2.90000    1350.0     600.0
   24.40     6.80000   3.90000   2.90000    1350.0     600.0
mantle
   24.40     8.11061   4.49094   3.38076    1446.0     600.0
   40.00     8.10119   4.48486   3.37906    1446.0     600.0
   60.00     8.08907   4.47715   3.37688    1447.0     600.0
   80.00     8.07688   4.46953   3.37471     195.0      80.0
  115.00     8.05540   4.45643   3.37091     195.0      80.0
</code></pre><p>与 tvel 格式类似，也是每行指定一个深度处的参数值。两个深度之间的参数通过线性插值得到。
若某个深度处有两个不同的参数值，则该深度处是一个速度界面。不同之处在于， nd 格式中没有
前两列注释行，且有专门的行来指定地球内部的重要界面：Moho、CMB 和 ICB。</p><h2 id=微调模型>微调模型</h2><p>假定要以 PREM 模型为基础来自定义模型。首先将标准 PREM 模型 <code>prem.nd</code> 复制一份到
工作目录，并重命名为 <code>model1.nd</code> 。直接执行如下命令就可以计算新模型下的震相走时。</p><pre><code>$ taup_time -mod model1 -ph p,P,Pn -h 5 -km 200

Model: model1
Distance   Depth   Phase   Travel    Ray Param  Takeoff  Incident  Purist    Purist
  (deg)     (km)   Name    Time (s)  p (s/deg)   (deg)    (deg)   Distance   Name
-----------------------------------------------------------------------------------
    1.80     5.0   P         29.09    13.657     45.47    45.43     1.80   = P
    1.80     5.0   Pn        29.09    13.657     45.47    45.43     1.80   = Pn
    1.80     5.0   P         31.60    16.312     58.38    58.30     1.80   = P
    1.80     5.0   P         31.75    16.187     57.67    57.60     1.80   = P
    1.80     5.0   p         34.48    19.158      0.00    87.84     1.80   = p
    1.80     5.0   P         34.73    18.961     81.80    81.50     1.80   = P
</code></pre><p>若 <code>-mod</code> 后的参数没有以 <code>.nd</code> 或 <code>.tvel</code> 结尾，则命令会首先到标准模型中找，若找不到则到当前
目录下找。</p><p>若 <code>-mod</code> 后的参数以 <code>.nd</code> 或 <code>.tvel</code> 结尾，则命令只会在当前目录下寻找模型文件。所以，在使用
自定义的模型时还是建议加上后缀比较好。</p><p>接下来就是修改模型了，基本上不乱改都不会出问题。</p><h2 id=加速计算>加速计算</h2><p>修改完模型后，TauP 中的所有命令就都可以使用这个模型了。如果你需要多次调用 TauP 来计算自定义模型
下的震相走时，你会发现，自定义的模型算走时总是比标准模型算的要慢。</p><p>出现这个现象是因为，TauP 已经针对每个标准模型计算了其对应的 tau 表。这个表的计算量很大，但只与模型
有关，与震中距、震源深度等都无关。因而先把这个表计算出来，则可以实现走时计算的加速。</p><p>计算表的方式也很简单：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ taup_create -nd model1.nd
$ taup_time -mod model1.taup -ph p,P,Pn -h <span style=color:#ae81ff>5</span> -km <span style=color:#ae81ff>200</span>
</code></pre></div><p><code>taup_create</code> 命令会生成一个后缀为 <code>.taup</code> 的二进制文件，这个文件可以直接在命令中使用，如上面
的第二个命令所示。</p></div><div class=post-copyright><p class=copyright-item><span class=item-title>文章作者</span>
<span class=item-content>SeisMan</span></p><p class=copyright-item><span class=item-title>上次更新</span>
<span class=item-content>2016-05-21</span></p></div><div class=post-reward><input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>赞赏支持</label><div class=qr-code><label class=qr-code-image for=reward><img class=image src=/images/wechatpay-qr-code.png>
<span>微信打赏</span></label>
<label class=qr-code-image for=reward><img class=image src=/images/alipay-qr-code.png>
<span>支付宝打赏</span></label></div></div><footer class=post-footer><div class=post-tags><a href=/tags/TauP/>TauP</a>
<a href=/tags/%E6%A8%A1%E5%9E%8B/>模型</a></div><nav class=post-nav><a class=prev href=/taup-identify-multiple-P-phases/><i class="iconfont icon-left"></i>
<span class="prev-text nav-default">识别 TauP 输出中的多个 P 震相</span>
<span class="prev-text nav-mobile">上一篇</span></a>
<a class=next href=/you-are-wanted/><span class="next-text nav-default">征集令</span>
<span class="next-text nav-mobile">下一篇</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><div id=disqus_thread></div><script type=text/javascript>(function(){var a,b;if(window.location.hostname==='localhost')return;a=document.createElement('script'),a.type='text/javascript',a.async=!0,b='seisman',a.src='//'+b+'.disqus.com/embed.js',(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:seisman.info@gmail.com class="iconfont icon-email" title=email></a><a href=https://github.com/seisman class="iconfont icon-github" title=github></a><a href=https://movie.douban.com/people/131919859 class="iconfont icon-douban" title=douban></a><a href=https://blog.seisman.info/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>由 <a class=hexo-link href=https://gohugo.io>Hugo</a> 强力驱动</span>
<span class=division>|</span>
<span class=theme-info>主题 -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2013 -
2021
<span class=heart><i class="iconfont icon-heart"></i></span>
<span class=author>SeisMan</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script type=text/javascript src=/lib/jquery/jquery-3.2.1.min.js></script><script type=text/javascript src=/lib/slideout/slideout-1.0.1.min.js></script><script type=text/javascript src=/lib/fancybox/jquery.fancybox-3.1.20.min.js></script><script type=text/javascript src=/dist/even.26188efa.min.js></script></body></html>